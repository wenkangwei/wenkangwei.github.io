<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>PySpark-Note-1 | Wenkang&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="article">
<meta property="og:title" content="PySpark-Note-1">
<meta property="og:url" content="https://github.com/wenkangwei/wenkangwei.github.io%60/2020/10/12/PySpark-Note-1/index.html">
<meta property="og:site_name" content="Wenkang&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-10-12T21:37:41.000Z">
<meta property="article:modified_time" content="2020-10-12T21:58:10.786Z">
<meta property="article:author" content="Wenkang Wei">
<meta property="article:tag" content="PySpark">
<meta property="article:tag" content="Data Analysis">
<meta property="article:tag" content="KMean Clustering">
<meta property="article:tag" content="Machine Learning">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Wenkang&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Wenkang&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://github.com/wenkangwei/wenkangwei.github.io`"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-PySpark-Note-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/12/PySpark-Note-1/" class="article-date">
  <time datetime="2020-10-12T21:37:41.000Z" itemprop="datePublished">2020-10-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PySpark/">PySpark</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      PySpark-Note-1
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <img src=https://miro.medium.com/max/800/1*nPcdyVwgcuEZiEZiRqApug.jpeg>
<a id="more"></a>

<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>This note is to introduce some useful functions in PySpark and also do some practice with them to analyze SF crime dataset. Then KMean Clustering model is applied to show how to use ML model in PySpark.</p>
<h2 id="List-of-Useful-Functions"><a href="#List-of-Useful-Functions" class="headerlink" title="List of Useful Functions"></a>List of Useful Functions</h2><ol>
<li><p>Create Spark Session</p>
<ul>
<li><p><strong>SparkSession</strong><br>  Create spark session, the main entry to create DataFrame, register DataFrame as tables, execute SQL over tables, cache tables, and read parquet files. </p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line">spark = SparkSession.builder \</span><br><span class="line">.master(<span class="string">&quot;local&quot;</span>) \</span><br><span class="line">.appName(<span class="string">&quot;Word Count&quot;</span>) \</span><br><span class="line">.config(<span class="string">&quot;spark.some.config.option&quot;</span>, <span class="string">&quot;some-value&quot;</span>) \</span><br><span class="line">.getOrCreate()</span><br></pre></td></tr></table></figure>
<p>  Explanation:</p>
<ul>
<li>.master(‘local’): sets the Spark master URL to connect to. “local” mean run spark locally. Just like a local server</li>
<li>.appName(“Word Count”) : application name</li>
<li>.config(“spark.some.config.option”, “some-value”): configure some key-value pair in application</li>
<li>.getOrCreate():  Gets an existing SparkSession or, if there is no existing one, creates a new one</li>
</ul>
</li>
<li><p><strong>SQLContext</strong><br> <strong>As of Spark 2.0, this is replaced by SparkSession</strong>. However, this class is kept here for backward compatibility.<br>  A SQLContext can be used create DataFrame, register DataFrame as tables, execute SQL over tables, cache tables,and read parquet files.</p>
</li>
</ul>
</li>
<li><p><strong>Load data</strong><br> After we create a SparkSession, we can use the following code to read data from CSV or JSON file.<br> <strong>Returned Object:</strong> PySpark DataFrame object</p>
<ul>
<li>csv<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Set delimiter = &quot;;&quot; between columns</span></span><br><span class="line"><span class="comment"># Skip header of file if header=True. </span></span><br><span class="line"><span class="comment"># Otherwise, load header as data record</span></span><br><span class="line">spark.read.options(header= <span class="literal">True</span>,delimiter=<span class="string">&quot;;&quot;</span>) \</span><br><span class="line">.csv(<span class="string">&quot;path-to-dataset/dataset.csv&quot;</span>)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">spark.read.options(header= <span class="literal">True</span>,delimiter=<span class="string">&quot;;&quot;</span>) \</span><br><span class="line">.<span class="built_in">format</span>(<span class="string">&#x27;csv&#x27;</span>).load(<span class="string">&quot;path-to-dataset/dataset.csv&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li>json<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spark.read.json(<span class="string">&quot;path-to-dataset/dataset.json&quot;</span>)</span><br><span class="line"><span class="comment">#or</span></span><br><span class="line">spark.read.<span class="built_in">format</span>(<span class="string">&#x27;json&#x27;</span>).load(<span class="string">&quot;path-to-dataset/dataset.json&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>Useful functions of pyspark.sql.DataFrame with SQL</strong></p>
</li>
</ol>
<ul>
<li><p><strong>Create DataFrame and SQL table</strong></p>
<ul>
<li><p><strong>df.createDataFrame(data, schema=None)</strong>:<br>  create  PySpark dataframe<br>  <strong>data</strong>: a list of tuples,each tuple contains the data of a row<br>  <strong>schema</strong>: a list of column names of dataframe</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spark = SparkSession.builder\</span><br><span class="line">.master(<span class="string">&quot;local&quot;</span>).appName(<span class="string">&quot;Word Count&quot;</span>)\</span><br><span class="line">.config(<span class="string">&quot;spark.some.config.option&quot;</span>, <span class="string">&quot;some-value&quot;</span>).getOrCreate()</span><br><span class="line">l1 = [(<span class="string">&#x27;Alice&#x27;</span>, <span class="number">1</span>)]</span><br><span class="line">new_row1 = spark.createDataFrame(l1,[<span class="string">&quot;name&quot;</span>,<span class="string">&quot;age&quot;</span>])</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>df.createGlobalTempView(view_name)</strong><br>  Creates a <em>global</em> temporary <em>view</em> with this DataFrame.</p>
</li>
<li><p><strong>df.createOrReplaceTempView(view_name):</strong><br>  Creates or replaces a <em>local</em> temporary <em>view</em> with this DataFrame.</p>
</li>
<li><p><strong>df.registerDataFrameAsTable(table_name):</strong><br>  Registers the given DataFrame as a <em>temporary table</em> in the catalog.</p>
<br>
</li>
</ul>
</li>
<li><p><strong>Show Columns, Rows, Statistic description</strong></p>
<ul>
<li><p><strong>df.columns</strong>: a list of column names</p>
</li>
<li><p><strong>df.summary()</strong>: Computes specified <strong>statistics</strong> for numeric and string columns, with <em>count - mean - stddev - min - max</em>.</p>
</li>
<li><p><strong>df.describe()</strong>: Computes basic statistics for numeric and string columns. Similar to <em>summary()</em></p>
</li>
<li><p><strong>df.printSchema()</strong>: print Schema / decriptions of each column, like data type</p>
<br>
</li>
</ul>
</li>
<li><p><strong>Query and Selection</strong></p>
<ul>
<li><p><strong>df.head(10)</strong>: return the top 10 rows in Row type, <strong>not DataFrame</strong></p>
</li>
<li><p><strong>df.tail(10)</strong>:return the last 10 rows in Row type, <strong>not DataFrame</strong></p>
</li>
<li><p><strong>df.where(condition) or df.filter(condition)</strong> :  select the rows which satisfy the conditions. <strong>Return a DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Select ages that are &lt; 100 and City name = &quot;SF&quot;</span></span><br><span class="line"><span class="comment"># Using SQL expression in conditions</span></span><br><span class="line">df.where(<span class="string">&quot;age &lt; 100 and city in (&#x27;SF&#x27;) &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Using Spark API</span></span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> Row</span><br><span class="line"><span class="keyword">from</span> pyspark.sql.functions <span class="keyword">import</span> col</span><br><span class="line">df.where(col(<span class="string">&quot;age&quot;</span>)&lt;<span class="number">100</span> &amp; col(<span class="string">&#x27;city&#x27;</span>).isin([<span class="string">&quot;SF&quot;</span>]))</span><br></pre></td></tr></table></figure></li>
<li><p><strong>df.column.isin([‘a’,’b’])</strong><br>Check if the value in a column is in the list or not</p>
</li>
<li><p><strong>df.column.between(lower_bound, upper_bound)</strong><br>check if the value is within a range or not</p>
</li>
<li><p><strong>df.select([“column-name”])</strong>:<br>select the columns based on a list of given column-names</p>
</li>
<li><p><strong>df.take(N)</strong>:<br>Return a list the top  N rows in Row() format</p>
</li>
<li><p><strong>df.collect()</strong>:<br>convert pyspark dataframe to a list of row in Row() format</p>
<br>
</li>
</ul>
</li>
<li><p><strong>Handle data</strong></p>
<ul>
<li><strong>df.withColumn(‘column_name’, col)</strong>:<br>append a column  to dataframe with name “column_name”</li>
</ul>
<p>  <strong>col</strong>: a Column expression for the new column. we can use UDF (user defined function) to it as well.</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = df.withColumn(<span class="string">&quot;age&quot;</span>, df.age+<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>df.withColumnRenamed(“old name”,”new name”)</strong>:<br>rename a column in the dataframe</p>
</li>
<li><p><strong>df.drop([“column-name”]),  df.dropna(subset =[“column-name”]))</strong>:<br>drop columns and drop the rows with NaN in selected columns</p>
</li>
<li><p><strong>df.dropDuplicates([“column-name-to-remove-duplicated-value”])</strong>:<br>drop duplicated rows in selected coumns</p>
</li>
<li><p><strong>df.fillna(), df.fill_duplicates()</strong>: fill na with given values</p>
</li>
<li><p><strong>df.spark.sql.Row(age=10, name=’A’)</strong>:<br>Return a row with elements: age=10, name=’A’</p>
</li>
<li><p><strong>df.orderBy([“column-name”], ascending=False), df.sortBy()</strong>:<br>orderBy is an alias of sortBy, they sort the dataframe along given column names</p>
</li>
<li><p><strong>df.groupby().agg() / df.groupby().count()</strong><br>Apply aggregation function, such as count()  to a group</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># First select group based on column A, B.  Then count the amount of group &quot;A&quot;</span></span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> functions <span class="keyword">as</span> F</span><br><span class="line">df.groupby([<span class="string">&quot;A&quot;</span>]).agg(F.count(df.A))</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>Append New Rows</strong>        </p>
<ul>
<li><p><strong>df.union()</strong>:<br>Return a new DataFrame containing union of rows in this and another DataFrame, based on <strong>position</strong>.</p>
</li>
<li><p><strong>df.unionByName([“colunm-name”])</strong><br>The difference between this function and union() is that this function <strong>resolves columns by name</strong> (not by position)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">new_row =  spark.createDataFrame([(<span class="string">&quot;A&quot;</span>,<span class="number">1</span>)],[<span class="string">&quot;name&quot;</span>,<span class="string">&quot;count&quot;</span>])</span><br><span class="line">df = df.union()</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>SQL</strong></p>
<ul>
<li>df = SparkSession.sql(“select * from table”)</li>
</ul>
</li>
<li><p><strong>Display Data</strong></p>
<ul>
<li>df.show(n)</li>
</ul>
</li>
<li><p><strong>Data Types Convertion with Pandas</strong>  </p>
<ul>
<li><p><strong>df.toPandas()</strong><br>convert dataframe to pandas dataframe</p>
</li>
<li><p><strong>df.toDF()</strong><br>convert a list of Rows to PySpark dataframe</p>
</li>
<li><p><strong>Convert Pandas DataFrame to PySpark DataFrame using Schema</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyspark.sql.types <span class="keyword">import</span> *</span><br><span class="line">mySchema = StructType([ StructField(<span class="string">&quot;col name1&quot;</span>, IntegerType(), <span class="literal">True</span>)\</span><br><span class="line">                    ,StructField(<span class="string">&quot;col name2&quot;</span>, StringType(), <span class="literal">True</span>)\</span><br><span class="line">                    ,StructField(<span class="string">&quot;col name3&quot;</span>, IntegerType(), <span class="literal">True</span>)])</span><br><span class="line">spark_df = spark.createDataFrame(df, mySchema)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<ol start="4">
<li>Using Resilient distributed Dataset (RDD)<br> RDD represents an immutable, partitioned collection of elements that can be operated on in parallel.<br> Please refer to the  official website about RDD<br>

</li>
</ol>
<h2 id="Practice-with-Example-SF-Crime-data"><a href="#Practice-with-Example-SF-Crime-data" class="headerlink" title="Practice with Example: SF Crime data"></a>Practice with Example: SF Crime data</h2><ol start="0">
<li><p><strong>Requirements:</strong></p>
<ul>
<li>Find a platform for distributed computing, like databricks</li>
<li>Install PySpark</li>
</ul>
</li>
<li><p><strong>Download SF Crime Data for Demo</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">r = requests.get(<span class="string">&quot;https://data.sfgov.org/api/views/tmnf-yvry/rows.csv?accessType=DOWNLOAD&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sf_crime.csv&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f</span><br><span class="line">    f.write(r.content)</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure></li>
<li><p>Load Data with PySpark</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"><span class="keyword">from</span> pyspark.sql.functions <span class="keyword">import</span> to_date, to_timestamp, hour</span><br><span class="line"><span class="keyword">from</span> pyspark.sql.functions <span class="keyword">import</span> year, month, dayofmonth, date_format</span><br><span class="line"><span class="keyword">from</span> pyspark.sql.functions <span class="keyword">import</span> from_unixtime, unix_timestamp</span><br><span class="line"></span><br><span class="line"><span class="comment"># create SparkSession entry to handle data</span></span><br><span class="line">spark = SparkSession \</span><br><span class="line">    .builder \</span><br><span class="line">    .appName(<span class="string">&quot;crime analysis&quot;</span>) \</span><br><span class="line">    .config(<span class="string">&quot;spark.some.config.option&quot;</span>, <span class="string">&quot;some-value&quot;</span>) \</span><br><span class="line">    .getOrCreate()</span><br><span class="line"><span class="comment"># load csv data</span></span><br><span class="line">df_opt1 = spark.read.option(<span class="string">&quot;header&quot;</span>, <span class="string">&quot;true&quot;</span>).csv(data_path)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong>Visualize Data</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a view called &quot;sf_crime&quot; to the dataframe, so that we can use SQL</span></span><br><span class="line"><span class="comment"># to query data later</span></span><br><span class="line">df_opt1.createOrReplaceTempView(<span class="string">&#x27;sf_crime&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#  if using databricks, we can use display function to see the data</span></span><br><span class="line">display(df_opt1 )</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">df_opt1.show()</span><br><span class="line"><span class="comment"># or </span></span><br><span class="line"><span class="comment"># show the schema of dataframe</span></span><br><span class="line">df_opt1.printSchema()</span><br></pre></td></tr></table></figure></li>
<li><strong>Clean Data</strong><br>Change the string data type to date type, integer type and other suitable data type</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># convert data type and replace data</span></span><br><span class="line">df_opt1 = df_opt1.withColumn(<span class="string">&#x27;Hour&#x27;</span>, hour(df_opt1[<span class="string">&#x27;Time&#x27;</span>]))</span><br><span class="line"><span class="comment"># convert string to date type using unix_timestamp</span></span><br><span class="line">df_opt1 = df_opt1.withColumn(<span class="string">&quot;Date&quot;</span>,  to_date( from_unixtime(unix_timestamp(df_opt1[<span class="string">&#x27;Date&#x27;</span>], <span class="string">&#x27;MM/dd/yyy&#x27;</span>))))</span><br><span class="line">df_opt1 = df_opt1.withColumn(<span class="string">&quot;Year&quot;</span>,  year(df_opt1.Date))</span><br><span class="line">df_opt1 = df_opt1.withColumn(<span class="string">&quot;Month&quot;</span>,  month(df_opt1.Date))</span><br><span class="line">df_opt1 = df_opt1.withColumn(<span class="string">&quot;Day&quot;</span>,  dayofmonth(df_opt1.Date))</span><br><span class="line">df_opt1 = df_opt1.withColumn(<span class="string">&#x27;HasCriminal&#x27;</span>, (df_opt1[<span class="string">&quot;category&quot;</span>]!=<span class="string">&quot;NON-CRIMINAL&quot;</span>))</span><br><span class="line">df_opt1 = df_opt1.withColumn(<span class="string">&quot;X&quot;</span>,  df_opt1[<span class="string">&quot;X&quot;</span>].cast(<span class="string">&quot;double&quot;</span>))</span><br><span class="line">df_opt1 = df_opt1.withColumn(<span class="string">&quot;Y&quot;</span>,  df_opt1[<span class="string">&quot;Y&quot;</span>].cast(<span class="string">&quot;double&quot;</span>))</span><br></pre></td></tr></table></figure>
<ol start="5">
<li><strong>Query and Select data I’m interested in</strong><br>I want to analyze the count of crime of each category here, so there are two ways to do this.</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Display Count of cime using SQL</span></span><br><span class="line">crimeCategory = spark.sql(<span class="string">&quot;SELECT  category, COUNT(*) AS crime_counts FROM sf_crime GROUP BY category ORDER BY crime_counts DESC&quot;</span>)</span><br><span class="line">crimes_pd_df = crimeCategory.toPandas()</span><br><span class="line">display(crimeCategory)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Display Count of crime of each category Using PySpark</span></span><br><span class="line">crime_category_df = df_opt1.groupby(<span class="string">&#x27;category&#x27;</span>).count().orderBy(<span class="string">&#x27;count&#x27;</span>,ascending=<span class="literal">False</span>)</span><br><span class="line">crime_category_df = crime_category_df.withColumnRenamed(<span class="string">&#x27;count&#x27;</span>, <span class="string">&#x27;crime_counts&#x27;</span>)</span><br><span class="line">crime_category_df = crime_category_df.toPandas()</span><br><span class="line">display(crime_category_df)</span><br></pre></td></tr></table></figure>
<p><strong>Result</strong></p>
<img src=/images/spark/count.png>

<h2 id="Advance-Topic-Machine-Learning-Model"><a href="#Advance-Topic-Machine-Learning-Model" class="headerlink" title="Advance Topic: Machine Learning Model"></a>Advance Topic: Machine Learning Model</h2><p>Using KMean Clustering to find the 5 centers in which crimes occur frequently</p>
<ol>
<li><strong>Select Position data X,Y and then Use Interquantile Range method to find outliers of position</strong><br>Since KMean Clustering is sensitive to the outlier as it uses mean method to find the center of clusters,  we need to remove outliers first. </li>
</ol>
<ul>
<li><strong>Quantile Based method to remove outlier</strong>:</li>
</ul>
<p><strong>The outlier is defined as the data point that drop outside the range [Q1-1.5<em>IQR ,  Q3+1.5</em>IQR]</strong>,<br>where Q1 and Q3 are  the first and third quantile of dataset and IQR = Q3-Q1 is the interquantile range.<br><br></p>
<ul>
<li><strong>API in PySpark to find quantile:</strong></li>
</ul>
<p><strong>df.approxQuantile(col, probabilities, relativeError)</strong>:<br><strong>col:</strong> column to find quantile<br><strong>probabilities:</strong> a list of quantile probabilities we want to find. Here I want to find Q1 =0.25 and  Q3=0.75<br><strong>return</strong>: the a list values that correspond to the quantile in probabilities list.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># select the positions where crimes occur</span></span><br><span class="line">crime_cluster_df = df_opt1.where(<span class="string">&quot;hasCriminal =true&quot;</span>).select([<span class="string">&quot;Hour&quot;</span>, <span class="string">&quot;PdDistrict&quot;</span>, <span class="string">&quot;X&quot;</span>,<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;DayOfWeek&quot;</span>, <span class="string">&quot;category&quot;</span>,<span class="string">&quot;Resolution&quot;</span>,<span class="string">&quot;hasCriminal&quot;</span>])</span><br><span class="line"><span class="comment"># crime_cluster_df.show()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Find the Q1, Q 3 Quantile</span></span><br><span class="line">bounds = &#123;</span><br><span class="line">    c: <span class="built_in">dict</span>(</span><br><span class="line">        <span class="built_in">zip</span>([<span class="string">&quot;q1&quot;</span>, <span class="string">&quot;q3&quot;</span>], crime_cluster_df.approxQuantile(c, [<span class="number">0.25</span>, <span class="number">0.75</span>], <span class="number">0</span>))</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> crime_cluster_df.select([<span class="string">&quot;X&quot;</span>,<span class="string">&quot;Y&quot;</span>]).columns</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># compute lower bound and upper bound of normal data</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> bounds:</span><br><span class="line">    iqr = bounds[c][<span class="string">&#x27;q3&#x27;</span>] - bounds[c][<span class="string">&#x27;q1&#x27;</span>]</span><br><span class="line">    bounds[c][<span class="string">&#x27;lower&#x27;</span>] = bounds[c][<span class="string">&#x27;q1&#x27;</span>] - (iqr * <span class="number">1.5</span>)</span><br><span class="line">    bounds[c][<span class="string">&#x27;upper&#x27;</span>] = bounds[c][<span class="string">&#x27;q3&#x27;</span>] + (iqr * <span class="number">1.5</span>)</span><br></pre></td></tr></table></figure>
<br>

<ol start="2">
<li><p>Remove Outliers based on upper bound and lower bound of quantile</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyspark.sql.functions <span class="keyword">import</span> *</span><br><span class="line">crime_cluster_df = crime_cluster_df.select([<span class="string">&quot;X&quot;</span>,<span class="string">&quot;Y&quot;</span>])\</span><br><span class="line">.where(col(<span class="string">&quot;X&quot;</span>).between(bounds[<span class="string">&#x27;X&#x27;</span>][<span class="string">&#x27;lower&#x27;</span>], bounds[<span class="string">&#x27;X&#x27;</span>][<span class="string">&#x27;upper&#x27;</span>])) \</span><br><span class="line">.where(col(<span class="string">&quot;Y&quot;</span>).between(bounds[<span class="string">&#x27;Y&#x27;</span>][<span class="string">&#x27;lower&#x27;</span>], bounds[<span class="string">&#x27;Y&#x27;</span>][<span class="string">&#x27;upper&#x27;</span>]))</span><br></pre></td></tr></table></figure>
<br>
</li>
<li><p>Assemble columns into one feature column before training<br>In PySpark, we need to put all feature columns into one single feature column  before we train the model.</p>
</li>
</ol>
<p><strong>VectorAssembler</strong> provides a way to assemble those features into one column.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ensemble multiple columns into one single feature column for training KMean Clustering</span></span><br><span class="line"><span class="keyword">from</span> pyspark.ml.feature <span class="keyword">import</span> VectorAssembler</span><br><span class="line">vecAssembler = VectorAssembler(inputCols=[<span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>], outputCol=<span class="string">&quot;features&quot;</span>)</span><br><span class="line">crime_cluster_df = vecAssembler.transform(crime_cluster_df.select([<span class="string">&quot;X&quot;</span>,<span class="string">&quot;Y&quot;</span>]))</span><br></pre></td></tr></table></figure>
<br>

<ol start="4">
<li>KMean Clustering to learn data<br>In Machine Learning of PySpark, we need to set the name of feature column to <strong>“features”</strong>, otherwise, set <code>featuresCol=&quot;column-name&quot;</code> to select which feature column to learn in dataframe</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Training KMean clustering</span></span><br><span class="line"><span class="keyword">from</span> pyspark.ml.clustering <span class="keyword">import</span> BisectingKMeans</span><br><span class="line">K=<span class="number">5</span></span><br><span class="line">bkm = BisectingKMeans(k=K, minDivisibleClusterSize=<span class="number">1.0</span>)</span><br><span class="line">model = bkm.fit(crime_cluster_df)</span><br><span class="line"><span class="comment"># predict at one single point</span></span><br><span class="line"><span class="comment"># print(model.predict(crime_cluster_df.head().features))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># predict clusters</span></span><br><span class="line"><span class="comment"># Output the prediction to the column called &quot;Prediction&quot;</span></span><br><span class="line">model.setPredictionCol(<span class="string">&quot;Prediction&quot;</span>)</span><br><span class="line">transformed = model.transform(crime_cluster_df).select(<span class="string">&quot;X&quot;</span>,<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;Prediction&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>Result</strong></p>
<img src=/images/spark/cluster.png>

<br>

<img src=/images/spark/centers.png>

<br>

<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>This tutorial introduce:</p>
<ol>
<li>List of useful PySpark functions and their basic usage</li>
<li>Use SF Crime dataset as a demo to see how to use PySpark to manipulate data and visualize them</li>
<li>How to use machine learning model: KMean Clustering in PySpark to learn data. <strong>Note: the APIs of ML in PySpark are  different from sklearn. Need to Pay attention to the difference.</strong><br>

</li>
</ol>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1] <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/python/pyspark.sql.html?highlight=read#pyspark.sql.DataFrameReader">SparkReader,Writer</a><br>[2] <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.filter">PySpark,SQL_module</a><br>[3] <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/2.2.0/api/python/_modules/pyspark/ml/classification.html">PySpark,ML_module</a><br>[4] <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/52633916/outlier-detection-in-pyspark">PySpark,outlier_detection</a><br>[5] <a target="_blank" rel="noopener" href="https://miro.medium.com/max/800/1*nPcdyVwgcuEZiEZiRqApug.jpeg">logo</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/wenkangwei/wenkangwei.github.io%60/2020/10/12/PySpark-Note-1/" data-id="cklak06yr002m6stya9edcvxi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Data-Analysis/" rel="tag">Data Analysis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/KMean-Clustering/" rel="tag">KMean Clustering</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PySpark/" rel="tag">PySpark</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/11/02/DL-ConvolutionNetwork/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          DeepLearning-1 ConvolutionNetwork
        
      </div>
    </a>
  
  
    <a href="/2020/09/30/ML-Model-LR/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ML Model - Regression models</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Checklist/">Checklist</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Collection/">Data Collection</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure/">Data Structure</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure/Sorting/">Sorting</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Deep-Learning/">Deep Learning</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/">Machine Learning</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/Ensemble-Method/">Ensemble Method</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/Ensemble-Method/Accuracy-Improvement/">Accuracy Improvement</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/">NLP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/Machine-Learning/">Machine Learning</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Parallel-Computing/">Parallel Computing</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Programming/">Programming</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PySpark/">PySpark</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Recommendation-System/">Recommendation System</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Report/">Report</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Searching/">Searching</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Searching/Data-Strucure/">Data Strucure</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Statistic/">Statistic</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Amdahl-s-Law/" rel="tag">Amdahl's Law</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Backpropagation/" rel="tag">Backpropagation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bagging/" rel="tag">Bagging</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BeautifulSoup/" rel="tag">BeautifulSoup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Binary-Tree/" rel="tag">Binary Tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Boosting/" rel="tag">Boosting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Boosting-Machine/" rel="tag">Boosting Machine</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BuckSort/" rel="tag">BuckSort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Collaborative-Filtering/" rel="tag">Collaborative Filtering</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Confusion-Metric/" rel="tag">Confusion Metric</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Convolution-Neural-Network/" rel="tag">Convolution Neural Network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cross-Validation/" rel="tag">Cross Validation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/D3-js/" rel="tag">D3.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Analysis/" rel="tag">Data Analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataScience/" rel="tag">DataScience</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dropout/" rel="tag">Dropout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ensemble-Learning/" rel="tag">Ensemble Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Holdout/" rel="tag">Holdout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Icarus/" rel="tag">Icarus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Independence-Test/" rel="tag">Independence Test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/K-Mean-Clustering/" rel="tag">K-Mean Clustering</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KMean-Clustering/" rel="tag">KMean Clustering</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LGBM/" rel="tag">LGBM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Model-Evaluation/" rel="tag">Model Evaluation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Model-Selection/" rel="tag">Model Selection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Natural-Language-Representations/" rel="tag">Natural Language Representations</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nature-Language-Processing/" rel="tag">Nature Language Processing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Negative-Sampling/" rel="tag">Negative Sampling</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/P-value/" rel="tag">P-value</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Parallel-Computing/" rel="tag">Parallel Computing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Parallel-Speedup/" rel="tag">Parallel Speedup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PySpark/" rel="tag">PySpark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROC-curve/" rel="tag">ROC curve</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Recommendation-System/" rel="tag">Recommendation System</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Regression/" rel="tag">Regression</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Regular-Expression/" rel="tag">Regular Expression</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sorting/" rel="tag">Sorting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stacking/" rel="tag">Stacking</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Traversal/" rel="tag">Traversal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unsupervised-Learning/" rel="tag">Unsupervised Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Variable-Selection/" rel="tag">Variable Selection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web-Scrapping/" rel="tag">Web Scrapping</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Wide-and-Deep/" rel="tag">Wide and Deep</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Wide-and-Deep-Model/" rel="tag">Wide and Deep Model</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Word-Embedding/" rel="tag">Word Embedding</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Word-vector/" rel="tag">Word vector</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/binary-search/" rel="tag">binary search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bubble-sort/" rel="tag">bubble sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/commands/" rel="tag">commands</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/insertion-sort/" rel="tag">insertion sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/merge-sort/" rel="tag">merge sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/non-parametric-learning/" rel="tag">non-parametric learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quick-sort/" rel="tag">quick sort</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Amdahl-s-Law/" style="font-size: 10px;">Amdahl's Law</a> <a href="/tags/Backpropagation/" style="font-size: 10px;">Backpropagation</a> <a href="/tags/Bagging/" style="font-size: 10px;">Bagging</a> <a href="/tags/BeautifulSoup/" style="font-size: 10px;">BeautifulSoup</a> <a href="/tags/Binary-Tree/" style="font-size: 10px;">Binary Tree</a> <a href="/tags/Boosting/" style="font-size: 10px;">Boosting</a> <a href="/tags/Boosting-Machine/" style="font-size: 10px;">Boosting Machine</a> <a href="/tags/BuckSort/" style="font-size: 10px;">BuckSort</a> <a href="/tags/Collaborative-Filtering/" style="font-size: 10px;">Collaborative Filtering</a> <a href="/tags/Confusion-Metric/" style="font-size: 10px;">Confusion Metric</a> <a href="/tags/Convolution-Neural-Network/" style="font-size: 10px;">Convolution Neural Network</a> <a href="/tags/Cross-Validation/" style="font-size: 10px;">Cross Validation</a> <a href="/tags/D3-js/" style="font-size: 10px;">D3.js</a> <a href="/tags/Data-Analysis/" style="font-size: 10px;">Data Analysis</a> <a href="/tags/DataScience/" style="font-size: 10px;">DataScience</a> <a href="/tags/Dropout/" style="font-size: 10px;">Dropout</a> <a href="/tags/Ensemble-Learning/" style="font-size: 10px;">Ensemble Learning</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Holdout/" style="font-size: 10px;">Holdout</a> <a href="/tags/Icarus/" style="font-size: 10px;">Icarus</a> <a href="/tags/Independence-Test/" style="font-size: 10px;">Independence Test</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/K-Mean-Clustering/" style="font-size: 10px;">K-Mean Clustering</a> <a href="/tags/KMean-Clustering/" style="font-size: 10px;">KMean Clustering</a> <a href="/tags/LGBM/" style="font-size: 20px;">LGBM</a> <a href="/tags/Machine-Learning/" style="font-size: 10px;">Machine Learning</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Model-Evaluation/" style="font-size: 10px;">Model Evaluation</a> <a href="/tags/Model-Selection/" style="font-size: 10px;">Model Selection</a> <a href="/tags/Natural-Language-Representations/" style="font-size: 10px;">Natural Language Representations</a> <a href="/tags/Nature-Language-Processing/" style="font-size: 10px;">Nature Language Processing</a> <a href="/tags/Negative-Sampling/" style="font-size: 10px;">Negative Sampling</a> <a href="/tags/P-value/" style="font-size: 10px;">P-value</a> <a href="/tags/Parallel-Computing/" style="font-size: 10px;">Parallel Computing</a> <a href="/tags/Parallel-Speedup/" style="font-size: 10px;">Parallel Speedup</a> <a href="/tags/PySpark/" style="font-size: 10px;">PySpark</a> <a href="/tags/ROC-curve/" style="font-size: 10px;">ROC curve</a> <a href="/tags/Recommendation-System/" style="font-size: 10px;">Recommendation System</a> <a href="/tags/Regression/" style="font-size: 10px;">Regression</a> <a href="/tags/Regular-Expression/" style="font-size: 10px;">Regular Expression</a> <a href="/tags/Sorting/" style="font-size: 10px;">Sorting</a> <a href="/tags/Stacking/" style="font-size: 10px;">Stacking</a> <a href="/tags/Traversal/" style="font-size: 10px;">Traversal</a> <a href="/tags/Unsupervised-Learning/" style="font-size: 10px;">Unsupervised Learning</a> <a href="/tags/Variable-Selection/" style="font-size: 10px;">Variable Selection</a> <a href="/tags/Web-Scrapping/" style="font-size: 10px;">Web Scrapping</a> <a href="/tags/Wide-and-Deep/" style="font-size: 10px;">Wide and Deep</a> <a href="/tags/Wide-and-Deep-Model/" style="font-size: 10px;">Wide and Deep Model</a> <a href="/tags/Word-Embedding/" style="font-size: 10px;">Word Embedding</a> <a href="/tags/Word-vector/" style="font-size: 10px;">Word vector</a> <a href="/tags/binary-search/" style="font-size: 10px;">binary search</a> <a href="/tags/bubble-sort/" style="font-size: 10px;">bubble sort</a> <a href="/tags/commands/" style="font-size: 10px;">commands</a> <a href="/tags/insertion-sort/" style="font-size: 10px;">insertion sort</a> <a href="/tags/merge-sort/" style="font-size: 10px;">merge sort</a> <a href="/tags/non-parametric-learning/" style="font-size: 10px;">non-parametric learning</a> <a href="/tags/quick-sort/" style="font-size: 10px;">quick sort</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/12/15/Recommendation-System-1/">Recommendation-System-1- Collaborative Filtering and Content-based Filtering</a>
          </li>
        
          <li>
            <a href="/2020/12/08/report/">CPSC 6300 Final Report</a>
          </li>
        
          <li>
            <a href="/2020/12/01/kkboxmusicrecommendation-notebook-v4/">KKBox Music Recommendation System</a>
          </li>
        
          <li>
            <a href="/2020/11/23/ML-K-mean-Cluster/">ML-K-mean-Cluster</a>
          </li>
        
          <li>
            <a href="/2020/11/22/Statistic-P-value/">Statistic-P-value</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Wenkang Wei<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>