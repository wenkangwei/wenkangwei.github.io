<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Recommendation-System-EGES - Wenkang&#039;s Blog</title><meta description=""><meta property="og:type" content="article"><meta property="og:title" content="Recommendation-System-EGES"><meta property="og:url" content="https://github.com/wenkangwei/"><meta property="og:site_name" content="Wenkang&#039;s Blog"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2021-08-02T22:04:17.000Z"><meta property="article:modified_time" content="2021-08-11T02:00:47.705Z"><meta property="article:author" content="Wenkang Wei"><meta property="article:tag" content="EGES"><meta property="article:tag" content="Graph Embedding"><meta property="twitter:card" content="summary"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/wenkangwei/wenkangwei.github.io%60/2021/08/03/Recommendation-System-GraphEmbedding/"},"headline":"Wenkang's Blog","image":[],"datePublished":"2021-08-02T22:04:17.000Z","dateModified":"2021-08-11T02:00:47.705Z","author":{"@type":"Person","name":"Wenkang Wei"},"description":""}</script><link rel="canonical" href="https://github.com/wenkangwei/wenkangwei.github.io%60/2021/08/03/Recommendation-System-GraphEmbedding/"><link rel="icon" href="/images/icon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/icon.png" alt="Wenkang&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-08-02T22:04:17.000Z" title="2021-08-02T22:04:17.000Z">2021-08-02</time><span class="level-item"><a class="link-muted" href="/categories/Recommendation-System/">Recommendation System</a></span><span class="level-item">22 minutes read (About 3247 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span> visits</span></div></div><h1 class="title is-3 is-size-4-mobile">Recommendation-System-EGES</h1><div class="content"><img src=https://raw.githubusercontent.com/wenkangwei/wenkangwei.github.io/master/images/Papers/EGES/eges-deepwalk-process.png>

<a id="more"></a>

<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>这篇文章主要回顾和介绍2018年Alibaba在KDD里面提出的的EGES(Enhanced Graph Embedding with Side information) 模型。 这个模型主要是在DeepWalk 学习到embedding的基础上增添了其他item的补充信息(side inforamtion). 在介绍EGES之前，先介绍一下过去Item2Vec以及DeepWalk 学习item的embedding的特点以及一些不足。 之后再介绍EGES的思路和训练方法。</p>
<h2 id="Item2Vec"><a href="#Item2Vec" class="headerlink" title="Item2Vec"></a>Item2Vec</h2><p>Item2Vec可以看成是Word2Vec 在推荐系统里面的推广。 Word2Vec 假设的是 在一个长为T的窗口/句子里面有{w1, w2,… wT}个单词，然后计算第i个单词(central word)和第j个单词（context word）的同时出现的隔离. 而ItemVec则是不考虑窗口的概念，而是考虑在用户的一个浏览的历史里面浏览过的商品{w1, w2,… wT}， 把单词替换成item。它的objective function是</p>
<p>$$<br>\mathbf{L} = \frac{1}{K} \sum_ {i=1}^k\sum_ {j \neq i}^k log(w _i | w _j)<br>$$</p>
<p><strong>Note: 在item2Vec的objective function里面它是计算每对商品之间的log的概率， 而word2Vec里面是计算给定的central word和其他context word之间的概率。这样看起来有点像是FM里面的特征两两交叉的操作</strong></p>
<p>Item2Vec 的一些特点</p>
<ul>
<li> 广义上来讲， 只要能通过item的特征生成特征向量的方法都是item2Vec.</li>
<li>Advantages:<ul>
<li>Item2Vec 是一个很广泛的概念，只要是序列数据都能够用来做embedding的学习，对item的embedding vector进行学习</li>
</ul>
</li>
<li>Disadvantages:<ul>
<li>和Word2Vec 一样， Item2Vec只用了序列的数据，比如item的购买序列，但是却没有用到其他的特征信息，比如item和item, user和user, user和item之间的关联信息(Relationship data), item的tag是补充信息。</li>
<li>为了解决Item2Vec只能用序列信息的问题， GraphEmbedding提供了很好的解决方案。Graph Embedding里面充分利用了item的补充信息外还能学习item，user之间的关联信息。而DeepWalk 就是其中一种GraphEmbedding的方法</li>
</ul>
</li>
</ul>
<h2 id="EGES"><a href="#EGES" class="headerlink" title="EGES"></a>EGES</h2><p>正如上面说的Item2Vec 只能用sequential data进行item的embedding vector学习，但是不能用到其他信息，比如item-item直接的关联，item的补充信息(categorical or numerical tags)。 而Graph Embedding的出现能够有效解决这个问题，之后也出现大量的graph embedding的学习方法。而 EGES (Enhanced Graph Embedding with Side Information) 就是其中之一。</p>
<h3 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h3><p>EGES (Enhanced Graph Embedding with Side Information) 是有Alibaba在2018年KDD里面提出来的基于DeepWalk的GraphEmbedding 方法结合了item补充信息而得到的模型。它先基于DeepWalk得到基本的GraphEmbedding 模型，然后逐步把Side Information添加到模型里面进行优化. 所以下面先解释DeepWalk, 之后再解释EGES模型</p>
<h3 id="DeepWalk-Basic-Graph-Embedding-BGE"><a href="#DeepWalk-Basic-Graph-Embedding-BGE" class="headerlink" title="DeepWalk / Basic Graph Embedding (BGE)"></a>DeepWalk / Basic Graph Embedding (BGE)</h3><p>DeepWalk 是在2014年KDD里面有Byran等人提出来的模型. Link：<a href="https://arxiv.org/pdf/1403.6652.pdf">https://arxiv.org/pdf/1403.6652.pdf</a></p>
<p>在应用到Alibaba的推荐系统里面后它的基本流程如下:<br><img src=https://wenkangwei.github.io/images/Papers/EGES/eges-deepwalk-process.png></p>
<ol>
<li><p>收集用户的历史浏览数据</p>
</li>
<li><p>根据浏览数据搭建item之间的有向概率图。图里面每个节点代表一个item，而item之间的边是有向边，每条边都有对应的跳转概率。概率的计算公式如下， $P(v _j | v _i)$ 是从节点vi跳到vj 的概率，$M _{ij}$ 是从节点vi跳到vj的边的权重， 而 $N _{+} (v _i)$ 是节点vi的out-degree(出边)的节点的集合。 $\epsilon$是图中所有边的集合</p>
<img src=https://wenkangwei.github.io/images/Papers/EGES/eges-deepwalk-possibility.png>
</li>
<li><p>在概率图中用RandomWalk 随机游走采样多个物品序列</p>
</li>
<li><p>用这些序列放到Word2Vec里面训练得到Embedding，而其中的Objective/loss function 和Word2Vec的一样（如下形式）, 都是minimize在center node已知的情况下context node的出现概率的negative log的值。</p>
</li>
</ol>
<img src=https://wenkangwei.github.io/images/Papers/EGES/eges-deepwalk-objective.png>

<h3 id="Graph-Embedding-with-Side-information-BES"><a href="#Graph-Embedding-with-Side-information-BES" class="headerlink" title="Graph Embedding with Side information (BES)"></a>Graph Embedding with Side information (BES)</h3><p>虽然DeepWalk学习到的embedding能够学习到Collabortive Filtering学不到的行为序列的关系，但是它依然有以下问题:</p>
<ul>
<li>不能解决冷启动问题，面对新进来的item, item的graph是没有新进来的item信息</li>
<li>item的其他side information比如 标签信息等并没有充分利用</li>
</ul>
<p>所以这里做的一个改进就是把side information也做embedding。得到item embedding以及side information的embedding。 其中$W _v^0$ 是原来学习到的item v 的embedding， $W _v^s$是第s个的side information的embedding。如果side information的embedding有n个，那么这个item v的embedding个数总共有n+1个，之后item v的所有embedding通过average pooling的方法进行信息融合得到对应item的embedding, 即$H _v$<br><img src=https://raw.githubusercontent.com/wenkangwei/wenkangwei.github.io/master/images/Papers/EGES/eges-ges-sideinfo.png></p>
<h3 id="Enhanced-Graph-Embedding-with-Side-information-EBES"><a href="#Enhanced-Graph-Embedding-with-Side-information-EBES" class="headerlink" title="Enhanced Graph Embedding with Side information (EBES)"></a>Enhanced Graph Embedding with Side information (EBES)</h3><p>那么问题又来了， 虽然GES能够通过side information解决冷启动的问题，但是每个用户对一个item的喜欢的信息是有倾向性的，比如一个用户喜欢一台手机是因为它是IPhone, 另一个用户喜欢一台手机是因为它是续航能力强,那么用户对这些特征的倾向性也应该反映到对embedding的倾向性上面，如对”Iphone” 或”续航能力强”这个tag的embedding的权重应该提高。 因此它对每个embedding应该加上一个权重。于是， item的embedding的形式被调整成下面形式</p>
<img src=https://raw.githubusercontent.com/wenkangwei/wenkangwei.github.io/master/images/Papers/EGES/eges-eges-sideinfo.png>

<p>其中：</p>
<ul>
<li>$a _v^j$ 是第v个item第j个embedding的权重值，由于要保证这个weight是大于0，于是用来exponent 作为底数</li>
<li>$H _v$是对第v个item所有embedding的weighted sum</li>
</ul>
<p>在更新了Embedding的公式之后，EGES的embedding再乘上一个output matrix然后做softmax进行概率的预测，这一点和Word2Vec 一样。<br><img src=https://raw.githubusercontent.com/wenkangwei/wenkangwei.github.io/master/images/Papers/EGES/eges-eges-framework.png></p>
<p>loss用的是binary cross entropy. $Z _u$ 是context node u的embedding的信息，$H _v$是center node的embedding信息。这里的context node在原文中是通过negative sampling方法来采样负样本的节点，和Word2Vec一样。<br><img src=https://raw.githubusercontent.com/wenkangwei/wenkangwei.github.io/master/images/Papers/EGES/eges-eges-objective.png></p>
<h3 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h3><p>原文里面用的评估方式也是传统的线下AUC和线上A/B CTR testing的评估。这个就不多说了<br><img src=https://raw.githubusercontent.com/wenkangwei/wenkangwei.github.io/master/images/Papers/EGES/eges-experiments-auc.png></p>
<img src=https://raw.githubusercontent.com/wenkangwei/wenkangwei.github.io/master/images/Papers/EGES/eges-experiments-ABtest.png>

<h2 id="Opinions"><a href="#Opinions" class="headerlink" title="Opinions"></a>Opinions</h2><p>这里对上面一些算法的思考:</p>
<ul>
<li>在DeepWalk 生成概率图来重新采样时，这个跳转的概率应该是要逼近实际的数据中两个item之间的有向关系，这种情况下，一般是要数据越大越好，才能逼近真实的关系</li>
<li>Deepwalk 里面的图只能计算已经知道的item之间的关系，对应新进来的item是始终有冷启动的问题。 而面对这个问题EGES是通过引入side information的embedding进行新的item信息填充来解决一开始新item没有embedding的情况</li>
<li>个人认为EGES创新性一般，主要还是在原因的deepwalk模型里面引入其他信息的embedding，而其他步骤基本上和Word2Vec一样。 不过这个其实能够解决冷启动问题而且也一定程度上提高了CTR的表现，算是比较实用的模型</li>
</ul>
<h2 id="Source-Code"><a href="#Source-Code" class="headerlink" title="Source Code"></a>Source Code</h2><!-- link to source code -->
<p>这里基于SparrowRecSys 开源推荐系统的github代码自己重新写了一遍 DeepWalk的graph embedding的计算. 我自己在弄的推荐系统的github：<a href="https://github.com/wenkangwei/RecSys">https://github.com/wenkangwei/RecSys</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br></pre></td><td class="code"><pre><span class="line">%%writefile embedding.py</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getItemSeqs</span><span class="params">(spark, samplesRating)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    extract item sequences for each user from dataframe</span></span><br><span class="line"><span class="string">    1. for each user, collect the corresponding visited movies and timestamp into a list</span></span><br><span class="line"><span class="string">    2. use UDF to process movie list and timestamp list to sort the movie sequence for each user</span></span><br><span class="line"><span class="string">    3. join the movie list to get a string for each user</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortF</span><span class="params">(movie_list, timestamp_list)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        sort by time and return the corresponding movie sequence</span></span><br><span class="line"><span class="string">        eg:</span></span><br><span class="line"><span class="string">            input: movie_list:[1,2,3]</span></span><br><span class="line"><span class="string">                   timestamp_list:[1112486027,1212546032,1012486033]</span></span><br><span class="line"><span class="string">            return [3,1,2]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        pairs = []</span><br><span class="line">        <span class="comment"># concat timestamp with movie id</span></span><br><span class="line">        <span class="keyword">for</span> m, t <span class="keyword">in</span> zip(movie_list, timestamp_list):</span><br><span class="line">            pairs.append((m, t))</span><br><span class="line">        <span class="comment"># sort by time</span></span><br><span class="line">        pairs = sorted(pairs, key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> [x[<span class="number">0</span>] <span class="keyword">for</span> x <span class="keyword">in</span> pairs]</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    sortUDF = udf(sortF, ArrayType(StringType()))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># rating data</span></span><br><span class="line">    <span class="comment">#ratingSamples.show(5)</span></span><br><span class="line">    <span class="comment"># ratingSamples.printSchema()</span></span><br><span class="line">    userSequence = samplesRating.where(F.col(<span class="string">"rating"</span>) &gt; <span class="number">3</span>) \</span><br><span class="line">                    .groupBy(<span class="string">"userId"</span>)\</span><br><span class="line">                    .agg(sortUDF(F.collect_list(<span class="string">"movieId"</span>), F.collect_list(<span class="string">"timestamp"</span>)).alias(<span class="string">"movieIds"</span>))\</span><br><span class="line">                    .withColumn(<span class="string">"movieIdStr"</span>, F.array_join(F.col(<span class="string">"movieIds"</span>), <span class="string">" "</span>))</span><br><span class="line">    seq = userSequence.select(<span class="string">"movieIdStr"</span>).rdd.map(<span class="keyword">lambda</span> x : x[<span class="number">0</span>].split(<span class="string">" "</span>))</span><br><span class="line">    <span class="comment">#print(seq.collect()[:5])</span></span><br><span class="line">    <span class="keyword">return</span> seq</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">embeddingLSH</span><span class="params">(spark, movieEmbMap)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Local sensitive hashing using bucketedRandomProjection</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    movieEmbSeq = []</span><br><span class="line">    <span class="keyword">for</span> key, embedding_list <span class="keyword">in</span> movieEmbMap.items():</span><br><span class="line">        embedding_list = [np.float64(embedding) <span class="keyword">for</span> embedding <span class="keyword">in</span> embedding_list]</span><br><span class="line">        movieEmbSeq.append((key, Vectors.dense(embedding_list)))</span><br><span class="line">    movieEmbDF = spark.createDataFrame(movieEmbSeq).toDF(<span class="string">"movieId"</span>, <span class="string">"emb"</span>)</span><br><span class="line">    bucketProjectionLSH = BucketedRandomProjectionLSH(inputCol=<span class="string">"emb"</span>, outputCol=<span class="string">"bucketId"</span>, bucketLength=<span class="number">0.1</span>,</span><br><span class="line">                                                      numHashTables=<span class="number">3</span>)</span><br><span class="line">    bucketModel = bucketProjectionLSH.fit(movieEmbDF)</span><br><span class="line">    embBucketResult = bucketModel.transform(movieEmbDF)</span><br><span class="line">    print(<span class="string">"movieId, emb, bucketId schema:"</span>)</span><br><span class="line">    embBucketResult.printSchema()</span><br><span class="line">    print(<span class="string">"movieId, emb, bucketId data result:"</span>)</span><br><span class="line">    embBucketResult.show(<span class="number">10</span>, truncate=<span class="literal">False</span>)</span><br><span class="line">    print(<span class="string">"Approximately searching for 5 nearest neighbors of the sample embedding:"</span>)</span><br><span class="line">    sampleEmb = Vectors.dense(<span class="number">0.795</span>, <span class="number">0.583</span>, <span class="number">1.120</span>, <span class="number">0.850</span>, <span class="number">0.174</span>, <span class="number">-0.839</span>, <span class="number">-0.0633</span>, <span class="number">0.249</span>, <span class="number">0.673</span>, <span class="number">-0.237</span>)</span><br><span class="line">    bucketModel.approxNearestNeighbors(movieEmbDF, sampleEmb, <span class="number">5</span>).show(truncate=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getTransitionMatrix</span><span class="params">(item_seq)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    build graph and transition matrix based on input item sequences </span></span><br><span class="line"><span class="string">    input: list of item sequence in RDD format</span></span><br><span class="line"><span class="string">    output: transition matrix and item distribution in dictionary format</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generate_pair</span><span class="params">(x)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        use a sliding window with size of 2 to generate item pairs</span></span><br><span class="line"><span class="string">        input: ls =  list of items </span></span><br><span class="line"><span class="string">        output: list of pairs</span></span><br><span class="line"><span class="string">        example:</span></span><br><span class="line"><span class="string">            input: [86, 90, 11, 100,]</span></span><br><span class="line"><span class="string">            output: [[86,90], [90, 11], [11,100]]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        res = []</span><br><span class="line">        prev = <span class="literal">None</span></span><br><span class="line">        print(x)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x)):</span><br><span class="line">            <span class="keyword">if</span> i &gt;<span class="number">0</span>:</span><br><span class="line">                res.append((x[i<span class="number">-1</span>],x[i]))</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#  convert item sequences to pair list </span></span><br><span class="line">    pair_seq = item_seq.flatMap(<span class="keyword">lambda</span> x: generate_pair(x))</span><br><span class="line">    <span class="comment"># convert pair list to  dictionary, key = pair, value = count</span></span><br><span class="line">    pair_count_dict = pair_seq.countByValue()</span><br><span class="line">    tot_count = pair_seq.count()</span><br><span class="line">    trans_matrix =  defaultdict(dict)</span><br><span class="line">    item_count = defaultdict(int)</span><br><span class="line">    item_dist = defaultdict(float)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># consider out-degree only </span></span><br><span class="line">    <span class="keyword">for</span> item, cnt <span class="keyword">in</span> pair_count_dict.items():</span><br><span class="line">        item1, item2 = item[<span class="number">0</span>], item[<span class="number">1</span>]</span><br><span class="line">        item_count[item1] +=  cnt</span><br><span class="line">        trans_matrix[item1][item2] = cnt</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> item, cnt <span class="keyword">in</span> pair_count_dict.items():</span><br><span class="line">        item1, item2 = item[<span class="number">0</span>], item[<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># possibility of transition</span></span><br><span class="line">        trans_matrix[item1][item2] /= item_count[item1]</span><br><span class="line">        <span class="comment"># distribution of each source node (item)</span></span><br><span class="line">        item_dist[item1] =  item_count[item1]/tot_count</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> trans_matrix, item_dist</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">oneRandomWalk</span><span class="params">(trans_mat, item_dist, sample_length)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    generate one random walk sequence based on transition matrix</span></span><br><span class="line"><span class="string">    input: </span></span><br><span class="line"><span class="string">        - trans_mat: transition matrix</span></span><br><span class="line"><span class="string">        - item_dist: distribution of item</span></span><br><span class="line"><span class="string">        - sample length: number of node in a path  = length of a walk -1 = length of edges - 1</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    rand_val = random.random()</span><br><span class="line">    <span class="comment"># randomly pick item based on CDF , cumulative density function, obtained from the item distribution</span></span><br><span class="line">    <span class="comment"># we can also randomly pick a item based on the distribution using  choice () function from numpy as well</span></span><br><span class="line">    cdf_prob =<span class="number">0</span></span><br><span class="line">    first_item = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> item, prob <span class="keyword">in</span> item_dist.items():</span><br><span class="line">        cdf_prob += prob</span><br><span class="line">        <span class="keyword">if</span> cdf_prob &gt;= rand_val:</span><br><span class="line">            first_item = item</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    item_list = [first_item]</span><br><span class="line">    cur_item = first_item</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> len(item_list) &lt; sample_length:</span><br><span class="line">        <span class="keyword">if</span> (cur_item <span class="keyword">not</span> <span class="keyword">in</span> item_dist) <span class="keyword">or</span> (cur_item <span class="keyword">not</span> <span class="keyword">in</span> trans_mat):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        cdf_prob = <span class="number">0</span></span><br><span class="line">        rand_val = random.random()</span><br><span class="line">        dist = trans_mat[cur_item]</span><br><span class="line">        <span class="keyword">for</span> item, prob <span class="keyword">in</span> dist.items():</span><br><span class="line">            cdf_prob += prob</span><br><span class="line">            <span class="keyword">if</span> cdf_prob &gt;= rand_val:</span><br><span class="line">                cur_item = item</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        item_list.append(cur_item)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> item_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateItemSeqs</span><span class="params">(trans_mat, item_dist, num_seq=<span class="number">20000</span>, sample_length = <span class="number">10</span>  )</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    use random walk to generate multiple item sequences</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    samples = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(num_seq):</span><br><span class="line">        samples.append(oneRandomWalk(trans_mat, item_dist, sample_length))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> samples</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trainItem2Vec</span><span class="params">(spark, item_seqs, emb_length, output_path, save_to_redis=False, redis_keyprefix=None)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    use Word2Vec to train item embedding</span></span><br><span class="line"><span class="string">    input:</span></span><br><span class="line"><span class="string">        - item_seqs: RDD pipeline instance, rather than dataframe</span></span><br><span class="line"><span class="string">    Note:  </span></span><br><span class="line"><span class="string">    - Word2Vec from mllib is a function that take RDD pipeline as input.</span></span><br><span class="line"><span class="string">    - Word2Vec from ml is a function that take Dataframe as input </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># train word2Vec</span></span><br><span class="line"><span class="comment">#     w2v = Word2Vec(vectorSize=emb_length, windowSize = 5, maxIter = 10, seed=42)</span></span><br><span class="line">    w2v = Word2Vec().setVectorSize(embLength).setWindowSize(<span class="number">5</span>).setNumIterations(<span class="number">10</span>)</span><br><span class="line">    model = w2v.fit(item_seqs)</span><br><span class="line">    <span class="comment"># test word2vec</span></span><br><span class="line">    synonyms = model.findSynonyms(<span class="string">"157"</span>, <span class="number">20</span>)</span><br><span class="line">    <span class="keyword">for</span> synonym, cos_similarity <span class="keyword">in</span> synonyms:</span><br><span class="line">        print(synonym, cos_similarity)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># save word2Vec to input path </span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(output_path):</span><br><span class="line">        os.makedirs(output_path)</span><br><span class="line">    <span class="keyword">with</span> open(output_path, <span class="string">"w"</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="keyword">for</span> movie_id <span class="keyword">in</span> model.getVectors():</span><br><span class="line">            <span class="comment"># convert vector to string type and store it</span></span><br><span class="line">            vector = <span class="string">" "</span>.join([str(emb) <span class="keyword">for</span> emb <span class="keyword">in</span> model.getVectors()[movie_id]])</span><br><span class="line">            pair = movie_id + <span class="string">":"</span> + vector + <span class="string">"\n"</span></span><br><span class="line">            fp.write(pair)</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getDeepWalk</span><span class="params">(spark, item_seq, sample_length=<span class="number">10</span>, num_walk=<span class="number">20000</span>, output_file=<span class="string">'../../data/modeldata/embedding.csv'</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">             save_to_redis=False, redis_key_prefix=None)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    use DeepWalk to generate graph embeddings</span></span><br><span class="line"><span class="string">    input:</span></span><br><span class="line"><span class="string">        - item_seq: RDD based sequence of item visited by a user</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># construct probability graph</span></span><br><span class="line">    trans_mat, item_dist = getTransitionMatrix(item_seq)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># generate sequence samples randomly</span></span><br><span class="line">    samples = generateItemSeqs(trans_mat, item_dist,num_seq=num_walk, sample_length = sample_length )</span><br><span class="line">    <span class="comment"># convert list of samples to spark rdd </span></span><br><span class="line">    samples_rdd = spark.sparkContext.parallelize(samples)</span><br><span class="line">    <span class="comment"># train item2Vec</span></span><br><span class="line">    graphEmbModel = trainItem2Vec(spark, samples_rdd, emb_length=<span class="number">10</span>, output_path=output_file , save_to_redis=<span class="literal">False</span>, redis_keyprefix=<span class="literal">None</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> graphEmbModel</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUserEmb</span><span class="params">( spark ,samples_rating, item_emb_model, output_file)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    generate user embedding based on item embedding</span></span><br><span class="line"><span class="string">    use map reduce to sum up embeddings of items purchased by user to generate user embedding</span></span><br><span class="line"><span class="string">    input:</span></span><br><span class="line"><span class="string">        - spark: spark session</span></span><br><span class="line"><span class="string">        - samples_rating: dataframe with rating, movieId, userId data</span></span><br><span class="line"><span class="string">        - item_emb_model: word2Vec/Item2Vec model trained by deep walk. </span></span><br><span class="line"><span class="string">        - output_file: file name of user embedding </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#     assert not item_emb or not item_emb_path, "Must input either item embedding vectors or path"</span></span><br><span class="line"><span class="comment">#     if item_emb_path != None:</span></span><br><span class="line"><span class="comment">#         item_emb = spark.read.csv(item_emb_path, header=True)</span></span><br><span class="line"></span><br><span class="line">    emb_dict = item_emb_model.getVectors()</span><br><span class="line">    item_emb_ls=[]</span><br><span class="line">    <span class="keyword">for</span> item, emb <span class="keyword">in</span> emb_dict.items():</span><br><span class="line">        <span class="comment">#print((item, emb))</span></span><br><span class="line">        item_emb_ls.append((item, list(emb)))</span><br><span class="line">    fields = [StructField(<span class="string">'movieId'</span>, StringType(),<span class="literal">False</span>),</span><br><span class="line">             StructField(<span class="string">'emb'</span>, ArrayType(FloatType()),<span class="literal">False</span>),]</span><br><span class="line">    item_emb_schema = StructType(fields)</span><br><span class="line">    item_emb_df = spark.createDataFrame(item_emb_ls, item_emb_schema)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># apply mapreduce to sum up item embeddings for each user to obtain user embedding</span></span><br><span class="line">    <span class="comment"># Note: we need inner join here to avoid empty item embedding during mapreduce calculation</span></span><br><span class="line">    user_emb = samples_rating.join(item_emb_df, on=<span class="string">"movieId"</span>, how=<span class="string">"inner"</span>)</span><br><span class="line">    print()</span><br><span class="line">    print(<span class="string">"User Embdding"</span>)</span><br><span class="line">    user_emb.show(<span class="number">5</span>)</span><br><span class="line">    user_emb.printSchema()</span><br><span class="line">    user_emb = user_emb.select(<span class="string">"userId"</span>,<span class="string">"emb"</span>).rdd.map(<span class="keyword">lambda</span> row: (row[<span class="number">0</span>], row[<span class="number">1</span>]) ).reduceByKey(<span class="keyword">lambda</span> emb1, emb2: [ float(emb1[i]) + float(emb2[i]) <span class="keyword">for</span> i <span class="keyword">in</span> range(len(emb1))] ).collect()</span><br><span class="line">    print(user_emb[:<span class="number">5</span>])</span><br><span class="line">    <span class="comment">#save user embedding</span></span><br><span class="line">    <span class="keyword">with</span> open(output_file,<span class="string">"w"</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="keyword">for</span> userId, emb <span class="keyword">in</span> user_emb:</span><br><span class="line">            row = <span class="string">" "</span>.join([str(e) <span class="keyword">for</span> e <span class="keyword">in</span> emb])</span><br><span class="line">            row = str(userId)+ <span class="string">":"</span>+ row + <span class="string">"\n"</span></span><br><span class="line">            fp.write(row)</span><br><span class="line">    print(<span class="string">"User Embedding Saved!"</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    conf = SparkConf().setAppName(<span class="string">'ctrModel'</span>).setMaster(<span class="string">'local'</span>)</span><br><span class="line">    spark = SparkSession.builder.config(conf=conf).getOrCreate()</span><br><span class="line">    <span class="comment"># Change to your own filepath</span></span><br><span class="line">    file_path = <span class="string">'../../data/'</span></span><br><span class="line">    rawSampleDataPath = file_path + <span class="string">"ratings.csv"</span></span><br><span class="line">    embLength = <span class="number">10</span></span><br><span class="line">    print(<span class="string">"Process ItemSquence..."</span>)</span><br><span class="line">    samplesRating = spark.read.csv(rawSampleDataPath, header = <span class="literal">True</span>)</span><br><span class="line">    item_seqs = getItemSeqs(spark, samplesRating)</span><br><span class="line">    <span class="comment">#print(samples)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#trainItem2Vec(item_seqs, emb_length=10, output_path=file_path+"modeldata/itemGraphEmb.csv", save_to_redis=False, redis_keyprefix=None)</span></span><br><span class="line">    </span><br><span class="line">    graphEmb = getDeepWalk(spark, item_seqs, sample_length=<span class="number">10</span>, num_walk=<span class="number">20000</span>, output_file=file_path+<span class="string">"modeldata/itemGraphEmb.csv"</span>,</span><br><span class="line">             save_to_redis=<span class="literal">False</span>, redis_key_prefix=<span class="literal">None</span>)</span><br><span class="line">    getUserEmb( spark ,samples_rating= samplesRating, item_emb_model= graphEmb, output_file= file_path+<span class="string">"modeldata/userEmb.csv"</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"Done!"</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1] Alibaba-EGES: <a href="https://arxiv.org/pdf/1803.02349v2.pdf">https://arxiv.org/pdf/1803.02349v2.pdf</a></p>
<p>[2] DeepWalk： <a href="https://arxiv.org/pdf/1403.6652.pdf">https://arxiv.org/pdf/1403.6652.pdf</a></p>
<p>[3] SparrowRecSys: <a href="https://time.geekbang.org/column/article/296932">https://time.geekbang.org/column/article/296932</a></p>
<p>[4] 推荐算法大佬的github： <a href="https://github.com/shenweichen/GraphEmbedding">https://github.com/shenweichen/GraphEmbedding</a></p>
<p>[5] DeepWalk的原文: <a href="http://www.perozzi.net/publications/14_kdd_deepwalk.pdf">http://www.perozzi.net/publications/14_kdd_deepwalk.pdf</a></p>
</div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/EGES/">EGES</a><a class="link-muted mr-2" rel="tag" href="/tags/Graph-Embedding/">Graph Embedding</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://ppoffice.github.io/hexo-theme-icarus-categorites-Plugins/Share/" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/08/12/ensemble-learning-XGBoost/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">XGBoost + LGBM</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/07/31/Recommendation-System-7-FFM/"><span class="level-item">Recommendation-System-7-FFM</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="content" id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread' ,
            appId: "kvXCKmDNxnA2486N29e5cP7i-MdYXbMMI",
            appKey: "0Lv5b0SqotzkGHQvD64u4AKo",
            
            avatar: "mm",
            
            meta: ["nick","mail","link"],
            pageSize: 10,
            lang: "en",
            
            highlight: true,
            
            
            
            
            
            requiredFields: [],
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://github.com/wenkangwei" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Github</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Data-Collection/"><span class="level-start"><span class="level-item">Data Collection</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Data-Structure/"><span class="level-start"><span class="level-item">Data Structure</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Data-Structure/Sorting/"><span class="level-start"><span class="level-item">Sorting</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Deep-Learning/"><span class="level-start"><span class="level-item">Deep Learning</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Icarus/"><span class="level-start"><span class="level-item">Icarus</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Icarus/Hexo/"><span class="level-start"><span class="level-item">Hexo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Icarus/Hexo/Website/"><span class="level-start"><span class="level-item">Website</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">8</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Machine-Learning/Accuracy-Improvement/"><span class="level-start"><span class="level-item">Accuracy Improvement</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/NLP/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Parallel-Computing/"><span class="level-start"><span class="level-item">Parallel Computing</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/PySpark/"><span class="level-start"><span class="level-item">PySpark</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Recommendation-System/"><span class="level-start"><span class="level-item">Recommendation System</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Report/"><span class="level-start"><span class="level-item">Report</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/SQL/"><span class="level-start"><span class="level-item">SQL</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Searching/"><span class="level-start"><span class="level-item">Searching</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Searching/Data-Strucure/"><span class="level-start"><span class="level-item">Data Strucure</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Statistic/"><span class="level-start"><span class="level-item">Statistic</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Website/"><span class="level-start"><span class="level-item">Website</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Website/ICarus/"><span class="level-start"><span class="level-item">ICarus</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Website/ICarus/Hexo/"><span class="level-start"><span class="level-item">Hexo</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Amdahl-s-Law/"><span class="tag">Amdahl&#039;s Law</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Backpropagation/"><span class="tag">Backpropagation</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bagging/"><span class="tag">Bagging</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BeautifulSoup/"><span class="tag">BeautifulSoup</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Binary-Tree/"><span class="tag">Binary Tree</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Blending/"><span class="tag">Blending</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Boosting/"><span class="tag">Boosting</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Boosting-Machine/"><span class="tag">Boosting Machine</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BuckSort/"><span class="tag">BuckSort</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Collaborative-Filtering/"><span class="tag">Collaborative Filtering</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Confusion-Metric/"><span class="tag">Confusion Metric</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Convolution-Neural-Network/"><span class="tag">Convolution Neural Network</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cross-Validation/"><span class="tag">Cross Validation</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/D3-js/"><span class="tag">D3.js</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DCN/"><span class="tag">DCN</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DIN/"><span class="tag">DIN</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Analysis/"><span class="tag">Data Analysis</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Mining/"><span class="tag">Data Mining</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Datawhale-Team-Learning/"><span class="tag">Datawhale Team Learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DeepFM/"><span class="tag">DeepFM</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dropout/"><span class="tag">Dropout</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EGES/"><span class="tag">EGES</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ensemble-Learning/"><span class="tag">Ensemble Learning</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FFM-Model/"><span class="tag">FFM Model</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GATE/"><span class="tag">GATE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GNN/"><span class="tag">GNN</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Graph/"><span class="tag">Graph</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Graph-Embedding/"><span class="tag">Graph Embedding</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Holdout/"><span class="tag">Holdout</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hypothesis-Test/"><span class="tag">Hypothesis Test</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Independence-Test/"><span class="tag">Independence Test</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Installation/"><span class="tag">Installation</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/K-Mean-Clustering/"><span class="tag">K-Mean Clustering</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/KMean-Clustering/"><span class="tag">KMean Clustering</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LGBM/"><span class="tag">LGBM</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Markdown/"><span class="tag">Markdown</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Model-Evaluation/"><span class="tag">Model Evaluation</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Model-Selection/"><span class="tag">Model Selection</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Natural-Language-Representations/"><span class="tag">Natural Language Representations</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Nature-Language-Processing/"><span class="tag">Nature Language Processing</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Negative-Sampling/"><span class="tag">Negative Sampling</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NeuralFM/"><span class="tag">NeuralFM</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/P-value/"><span class="tag">P-value</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Parallel-Computing/"><span class="tag">Parallel Computing</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Parallel-Speedup/"><span class="tag">Parallel Speedup</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PySpark/"><span class="tag">PySpark</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROC-curve/"><span class="tag">ROC curve</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Recommendation-System/"><span class="tag">Recommendation System</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regression/"><span class="tag">Regression</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regular-Expression/"><span class="tag">Regular Expression</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Sorting/"><span class="tag">Sorting</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Stacking/"><span class="tag">Stacking</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Swing/"><span class="tag">Swing</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Traversal/"><span class="tag">Traversal</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tutorial/"><span class="tag">Tutorial</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Unsupervised-Learning/"><span class="tag">Unsupervised Learning</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Variable-Selection/"><span class="tag">Variable Selection</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WSDM/"><span class="tag">WSDM</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web-Scrapping/"><span class="tag">Web Scrapping</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Wide-and-Deep/"><span class="tag">Wide and Deep</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Wide-and-Deep-Model/"><span class="tag">Wide and Deep Model</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Wide-Deep-Model/"><span class="tag">Wide&amp;Deep Model</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Word-Embedding/"><span class="tag">Word Embedding</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Word-vector/"><span class="tag">Word vector</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/binary-search/"><span class="tag">binary search</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bubble-sort/"><span class="tag">bubble sort</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/commands/"><span class="tag">commands</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/insertion-sort/"><span class="tag">insertion sort</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/merge-sort/"><span class="tag">merge sort</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/non-parametric-learning/"><span class="tag">non-parametric learning</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/quick-sort/"><span class="tag">quick sort</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/review/"><span class="tag">review</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/statistic-analytics-tool/"><span class="tag">statistic analytics tool</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2021-09-13T03:08:12.000Z">2021-09-12</time></p><p class="title is-6"><a class="link-muted" href="/2021/09/13/Recommendation-System-9-Swing/">Recommendation-System-9-Swing</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Recommendation-System/">Recommendation System</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-08-12T13:59:35.000Z">2021-08-12</time></p><p class="title is-6"><a class="link-muted" href="/2021/08/12/ensemble-learning-XGBoost/">XGBoost + LGBM</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Machine-Learning/">Machine Learning</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-08-02T22:04:17.000Z">2021-08-02</time></p><p class="title is-6"><a class="link-muted" href="/2021/08/03/Recommendation-System-GraphEmbedding/">Recommendation-System-EGES</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Recommendation-System/">Recommendation System</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-07-30T17:07:01.000Z">2021-07-30</time></p><p class="title is-6"><a class="link-muted" href="/2021/07/31/Recommendation-System-7-FFM/">Recommendation-System-7-FFM</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Recommendation-System/">Recommendation System</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-07-28T14:53:13.000Z">2021-07-28</time></p><p class="title is-6"><a class="link-muted" href="/2021/07/28/SQL-Installation/">SQL-Installation</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/SQL/">SQL</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/03/"><span class="level-start"><span class="level-item">March 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/avatar.jpg" alt="Wenkang Wei"></figure><p class="title is-size-4 is-block line-height-inherit">Wenkang Wei</p><p class="is-size-6 is-block">computer engineering| machine learning</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Clemson,SC</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">56</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">25</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">76</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/wenkangwei" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/wenkangwei"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/wenkang-wei-588811167"><i class="fab fa-linkedin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a></div></div></div><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="is-flex" href="#Introduction"><span class="mr-2">1</span><span>Introduction</span></a></li><li><a class="is-flex" href="#Item2Vec"><span class="mr-2">2</span><span>Item2Vec</span></a></li><li><a class="is-flex" href="#EGES"><span class="mr-2">3</span><span>EGES</span></a><ul class="menu-list"><li><a class="is-flex" href="#Motivation"><span class="mr-2">3.1</span><span>Motivation</span></a></li><li><a class="is-flex" href="#DeepWalk-Basic-Graph-Embedding-BGE"><span class="mr-2">3.2</span><span>DeepWalk / Basic Graph Embedding (BGE)</span></a></li><li><a class="is-flex" href="#Graph-Embedding-with-Side-information-BES"><span class="mr-2">3.3</span><span>Graph Embedding with Side information (BES)</span></a></li><li><a class="is-flex" href="#Enhanced-Graph-Embedding-with-Side-information-EBES"><span class="mr-2">3.4</span><span>Enhanced Graph Embedding with Side information (EBES)</span></a></li><li><a class="is-flex" href="#Experiment"><span class="mr-2">3.5</span><span>Experiment</span></a></li></ul></li><li><a class="is-flex" href="#Opinions"><span class="mr-2">4</span><span>Opinions</span></a></li><li><a class="is-flex" href="#Source-Code"><span class="mr-2">5</span><span>Source Code</span></a></li><li><a class="is-flex" href="#Reference"><span class="mr-2">6</span><span>Reference</span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/icon.png" alt="Wenkang&#039;s Blog" height="28"></a><p class="size-small"><span>&copy; 2021 Wenkang Wei</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://github.com/wenkangwei/wenkangwei.github.io`',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://s9.cnzz.com/z_stat.php?id=1280124407&amp;web_id=1280124407" async></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>